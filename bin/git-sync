#!/bin/bash
#
# Synchronize current Git branch with the master branch.
#

# Uncomment to see debug output.
#set -x

CURRENT_BRANCH=$(git branch | grep \* | cut -d ' ' -f2)

run_cmd() {
    cmd=$1
    echo "--> $cmd"
    $cmd
}

if [[ $CURRENT_BRANCH == "master" ]]; then
    run_cmd 'git pull'
    run_cmd 'git push'
else
    run_cmd 'git checkout master'
    run_cmd 'git pull'
    run_cmd "git checkout $CURRENT_BRANCH"
    run_cmd "git merge master"
    run_cmd 'git push'
fi

#!/bin/bash
#
# Synchronize current Git branch with the master branch.
#

# Colors for terminal.
bldred='\033[31m'
bldgrn='\033[1;32m'
bldblu='\033[1;34m'
txtrst='\033[0m'

# Check we are in a git repository.
if ! git status > /dev/null 2>&1; then
    echo -e "${bldred}>>${txtrst} Not a git repository, exiting ..."
    exit 1
fi

CURRENT_BRANCH=$(git branch | grep \* | cut -d ' ' -f2)

run_cmd() {
    cmd=$1
    echo -e "${bldgrn}>>${txtrst} $cmd"
    $cmd
}

if [[ $CURRENT_BRANCH == "master" ]]; then
    run_cmd 'git pull'
    run_cmd 'git push'
else
    run_cmd 'git checkout master'
    run_cmd 'git pull'
    run_cmd "git checkout $CURRENT_BRANCH"
    run_cmd "git merge master"
    run_cmd 'git push'
fi

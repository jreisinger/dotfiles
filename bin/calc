#!/usr/bin/perl -s
use strict;
use warnings;

our ($h);
if ($h) {
    print "Simple Perl eval based calculator\n";
    exit 0;
}

# Allowed input characters regex...
my $allowed = '\d\+\-\/\*';

my $expr = "@ARGV";
$expr =~ s/\s+//g;             # allow whitespace in input numbers
$expr =~ s/x/*/gi;             # allow x instead of * in input
$expr =~ s/[^$allowed]//gi;    # remove any non-allowed chars

# Do the calculation...
my $res = eval "$expr";
die "Does not compute...$expr\n" unless $res;

# Show thousands in result but not when a decimal
$res =~ s/(\d{1,3}?)(?=(\d{3})+$)/$1 /g unless $res =~ /\./;
print "$expr = $res\n";
print "(@ARGV)\n";
